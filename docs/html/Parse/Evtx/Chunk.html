<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Parse::Evtx::Chunk - parses a chunk of a Microsoft Windows Vista event log 
file</title>
<link rel="stylesheet" href="./docs/html/default.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:kiddi@dhcp-172-19-33-45.mtv.corp.google.com" />
</head>

<body>


<!-- INDEX BEGIN -->
<div name="index">
<p><a name="__index__"></a></p>

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#methods">METHODS</a></li>
	<ul>

		<li><a href="#new">new</a></li>
		<ul>

			<li><a href="#parameters">Parameters</a></li>
		</ul>

		<li><a href="#check">check</a></li>
		<li><a href="#get_first_event">get_first_event</a></li>
		<li><a href="#get_next_event">get_next_event</a></li>
		<li><a href="#get_start">get_start</a></li>
		<li><a href="#get_length">get_length</a></li>
	</ul>

	<li><a href="#diagnostics">DIAGNOSTICS</a></li>
	<li><a href="#dependencies">DEPENDENCIES</a></li>
	<li><a href="#see_also">SEE ALSO</a></li>
	<li><a href="#history">HISTORY</a></li>
	<li><a href="#author">AUTHOR</a></li>
	<li><a href="#license_and_copyright">LICENSE AND COPYRIGHT</a></li>
</ul>

<hr name="index" />
</div>
<!-- INDEX END -->

<p>
</p>
<h1><a name="name">NAME</a></h1>
<p>Parse::Evtx::Chunk - parses a chunk of a Microsoft Windows Vista event log 
file (.evtx)</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<pre>
        use Parse::Evtx::Chunk;
        
    # create an object for your event log file
    my $fh = IO::File-&gt;new('justachunk.bin', &quot;r&quot;);
    
    # create a chunk object
    my $parser = Parse::Evtx::Chunk-&gt;new('FH' =&gt; $fh);</pre>
<pre>
    # iterate through all event records
    my $event = $parser-&gt;get_first_event();
    while (defined $event) {
        print $event-&gt;get_xml();
        $event = $file-&gt;get_next_event();
    };
    
    # all done, close the file handle
    $fh-&gt;close();       
        
=head1 DESCRIPTION</pre>
<p>Microsoft Windows Vista records events in a proprietary binary file format. 
An object of this class represents a parser for a chunk of a Vista event log 
file. A chunk is a block of 64 kiB of data, that consists of header 
information, internal tables and event data. The main purpose of this modules 
is to translate event log files from their native binary form into textual 
XML.</p>
<p>The chunk object provides central services to other classes, e.g. stacks
for elements, strings and XML templates.</p>
<p>
</p>
<hr />
<h1><a name="methods">METHODS</a></h1>
<p>
</p>
<h2><a name="new">new</a></h2>
<p>This is the constructor for the parser class.</p>
<p>
</p>
<h3><a name="parameters">Parameters</a></h3>
<dl>
<dt><strong><a name="fh2" class="item">FH</a></strong></dt>

<dd>
<p>This is a handle object for the event log file. The object is required to be a
descendant of IO::File.</p>
</dd>
<dt><strong><a name="start" class="item">Start</a></strong></dt>

<dd>
<p>Offset into the file handle where the chunk is expected to start. This 
parameter is optional; it defaults to 0.</p>
</dd>
</dl>
<p>
</p>
<h2><a name="check">check</a></h2>
<p>This method checks the chunk for certain errors and marks them in a
return code. Right now, only the CRC32 check of the chunk header is
implemented.</p>
<p>
</p>
<h2><a name="get_first_event">get_first_event</a></h2>
<p>This method retrieves the first event record from a file. It returns an 
<a href="./docs/html/./Parse/Evtx/Event.html">the Parse::Evtx::Event manpage</a> object on success and <code>undef</code> on failure. Note that 
get_first_event changes the file pointer in the associated file handle object.</p>
<p>
</p>
<h2><a name="get_next_event">get_next_event</a></h2>
<p>This method retrieves the next event record from a file. It returns an 
<a href="./docs/html/./Parse/Evtx/Event.html">the Parse::Evtx::Event manpage</a> object on success and <code>undef</code> on failure. Note that 
get_next_event changes the file pointer in the associated file handle object.</p>
<p>
</p>
<h2><a name="get_start">get_start</a></h2>
<p>Returns the offset into the file</p>
<p>
</p>
<h2><a name="get_length">get_length</a></h2>
<p>Returns the lengths of the section of the log file that corresponds with the
chunk object.</p>
<p>
</p>
<hr />
<h1><a name="diagnostics">DIAGNOSTICS</a></h1>
<p><strong>new</strong> returns <code>undef</code>, if it doesn't recognize the format of the file.</p>
<p>Other errors will be signalled through assertions and <code>die()</code>.</p>
<p>
</p>
<hr />
<h1><a name="dependencies">DEPENDENCIES</a></h1>
<p>This module depends on the following non-standard modules, which are also not 
part of this package:</p>
<dl>
<dt><strong><a name="carp_assert2" class="item">Carp::Assert</a></strong></dt>

<dt><strong><a name="data_hexify2" class="item">Data::Hexify</a></strong></dt>

<dt><strong><a name="digest_crc322" class="item">Digest::Crc32</a></strong></dt>

<dt><strong><a name="math_bigint2" class="item">Math::BigInt</a></strong></dt>

</dl>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p><a href="./docs/html/./Log2t/input/evt.html">Log2t::input::evt</a>, <a href="./docs/html/./Log2t/input/urlsnarf.html">Log2t::input::urlsnarf</a>, <a href="./docs/html/./Log2t/input/firefox2.html">Log2t::input::firefox2</a>, <a href="./docs/html/./Parse/Evtx/BXmlNode/Node0x04.html">Parse::Evtx::BXmlNode::Node0x04</a>, <a href="./docs/html/./Log2t/input/pdf.html">Log2t::input::pdf</a>, <a href="./docs/html/dev/template_for_input_module_logfile.html">dev::template_for_input_module_logfile</a>, <a href="./docs/html/./Log2t/input/proftpd_xferlog.html">Log2t::input::proftpd_xferlog</a>, <a href="./docs/html/./Log2t/input/volatility.html">Log2t::input::volatility</a>, <a href="./docs/html/./Log2t/input/mssql_errlog.html">Log2t::input::mssql_errlog</a>, <a href="./docs/html/./Parse/Evtx/Const.html">Parse::Evtx::Const</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x04.html">Parse::Evtx::VariantType::Type0x04</a>, <a href="./docs/html/./Log2t/input/analog_cache.html">Log2t::input::analog_cache</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x08.html">Parse::Evtx::VariantType::Type0x08</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x0e.html">Parse::Evtx::VariantType::Type0x0e</a>, <a href="./docs/html/./Parse/Evtx/Chunk.html">Parse::Evtx::Chunk</a>, <a href="./docs/html/./Log2t/input/apache2_access.html">Log2t::input::apache2_access</a>, <a href="./docs/html/./Log2t/output/beedocs.html">Log2t::output::beedocs</a>, <a href="./docs/html/./Log2t/input/mft.html">Log2t::input::mft</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x03.html">Parse::Evtx::VariantType::Type0x03</a>, <a href="./docs/html/./Log2Timeline.html">Log2Timeline</a>, <a href="./docs/html/./Parse/Evtx/BXmlNode/SubstArray.html">Parse::Evtx::BXmlNode::SubstArray</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x05.html">Parse::Evtx::VariantType::Type0x05</a>, <a href="./docs/html/./Parse/Evtx/BXmlNode/Node0x01.html">Parse::Evtx::BXmlNode::Node0x01</a>, <a href="./docs/html/./Log2t/input/symantec.html">Log2t::input::symantec</a>, <a href="./docs/html/./Log2t/input/firefox3.html">Log2t::input::firefox3</a>, <a href="./docs/html/./Log2t/input/isatxt.html">Log2t::input::isatxt</a>, <a href="./docs/html/./Log2t/output/mactime_l.html">Log2t::output::mactime_l</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x0d.html">Parse::Evtx::VariantType::Type0x0d</a>, <a href="./docs/html/./Log2t/output/tab.html">Log2t::output::tab</a>, <a href="./docs/html/./Log2t/BinRead.html">Log2t::BinRead</a>, <a href="./docs/html/./Parse/Evtx/BXmlNode/Node0x05.html">Parse::Evtx::BXmlNode::Node0x05</a>, <a href="./docs/html/./Log2t/output/tln.html">Log2t::output::tln</a>, <a href="./docs/html/./Log2t/output/cef.html">Log2t::output::cef</a>, <a href="./docs/html/./Parse/Evtx/BXmlNode/NameString.html">Parse::Evtx::BXmlNode::NameString</a>, <a href="./docs/html/./Log2t/input/xpfirewall.html">Log2t::input::xpfirewall</a>, <a href="./docs/html/./Log2t/input/opera.html">Log2t::input::opera</a>, <a href="./docs/html/./Log2t/input/iis.html">Log2t::input::iis</a>, <a href="./docs/html/./Log2t/input/oxml.html">Log2t::input::oxml</a>, <a href="./docs/html/./Log2t/input/win_link.html">Log2t::input::win_link</a>, <a href="./docs/html/./Log2t/Time.html">Log2t::Time</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x09.html">Parse::Evtx::VariantType::Type0x09</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x12.html">Parse::Evtx::VariantType::Type0x12</a>, <a href="./docs/html/./Log2t/input/altiris.html">Log2t::input::altiris</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x15.html">Parse::Evtx::VariantType::Type0x15</a>, <a href="./docs/html/./Log2t/input/pcap.html">Log2t::input::pcap</a>, <a href="./docs/html/./Log2t/input/exif.html">Log2t::input::exif</a>, <a href="./docs/html/./Log2t/input/mcafee.html">Log2t::input::mcafee</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x95.html">Parse::Evtx::VariantType::Type0x95</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x94.html">Parse::Evtx::VariantType::Type0x94</a>, <a href="./docs/html/./Log2t/PreProc/user_browser.html">Log2t::PreProc::user_browser</a>, <a href="./docs/html/./Log2t/input/recycler.html">Log2t::input::recycler</a>, <a href="./docs/html/./Log2t/input/openvpn.html">Log2t::input::openvpn</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x0c.html">Parse::Evtx::VariantType::Type0x0c</a>, <a href="./docs/html/./Log2t/output/simile.html">Log2t::output::simile</a>, <a href="./docs/html/./Log2t/input/mactime.html">Log2t::input::mactime</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x13.html">Parse::Evtx::VariantType::Type0x13</a>, <a href="./docs/html/./Parse/Evtx.html">Parse::Evtx</a>, <a href="./docs/html/./Log2t/input/evtx.html">Log2t::input::evtx</a>, <a href="./docs/html/./Parse/Evtx/VariantType.html">Parse::Evtx::VariantType</a>, <a href="./docs/html/./Log2t/input/tln.html">Log2t::input::tln</a>, <a href="./docs/html/./Parse/Evtx/BXmlNode.html">Parse::Evtx::BXmlNode</a>, <a href="./docs/html/./Log2t/base/input.html">Log2t::base::input</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x21.html">Parse::Evtx::VariantType::Type0x21</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x0f.html">Parse::Evtx::VariantType::Type0x0f</a>, <a href="./docs/html/./Parse/Evtx/BXmlNode/Node0x0d.html">Parse::Evtx::BXmlNode::Node0x0d</a>, <a href="./docs/html/./Parse/Evtx/BXmlNode/Node0x0c.html">Parse::Evtx::BXmlNode::Node0x0c</a>, <a href="./docs/html/./Log2t/Numbers.html">Log2t::Numbers</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x06.html">Parse::Evtx::VariantType::Type0x06</a>, <a href="./docs/html/./Log2t/output/csv.html">Log2t::output::csv</a>, <a href="./docs/html/./Log2t/input/skype_sql.html">Log2t::input::skype_sql</a>, <a href="./docs/html/./Log2t/input/l2t_csv.html">Log2t::input::l2t_csv</a>, <a href="./docs/html/./Log2t/input/squid.html">Log2t::input::squid</a>, <a href="./docs/html/./Log2t/input/security.html">Log2t::input::security</a>, <a href="./docs/html/./Parse/Evtx/BXmlNode/Root.html">Parse::Evtx::BXmlNode::Root</a>, <a href="./docs/html/./Log2t/input/apache2_error.html">Log2t::input::apache2_error</a>, <a href="./docs/html/./Log2t/input/ftk_dirlisting.html">Log2t::input::ftk_dirlisting</a>, <a href="./docs/html/./Parse/Evtx/BXmlNode/Template.html">Parse::Evtx::BXmlNode::Template</a>, <a href="./docs/html/./Parse/Evtx/BXmlNode/Node0x0f.html">Parse::Evtx::BXmlNode::Node0x0f</a>, <a href="./docs/html/./Log2t/output/cftl.html">Log2t::output::cftl</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x01.html">Parse::Evtx::VariantType::Type0x01</a>, <a href="./docs/html/./Log2t/input/software.html">Log2t::input::software</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x0b.html">Parse::Evtx::VariantType::Type0x0b</a>, <a href="./docs/html/dev/template_for_output_module.html">dev::template_for_output_module</a>, <a href="./docs/html/./Log2t/input/iehistory.html">Log2t::input::iehistory</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x07.html">Parse::Evtx::VariantType::Type0x07</a>, <a href="./docs/html/./Log2t/input/restore.html">Log2t::input::restore</a>, <a href="./docs/html/./Log2t/input/sam.html">Log2t::input::sam</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x0a.html">Parse::Evtx::VariantType::Type0x0a</a>, <a href="./docs/html/./Parse/Evtx/BXmlNode/Node0x00.html">Parse::Evtx::BXmlNode::Node0x00</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x14.html">Parse::Evtx::VariantType::Type0x14</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x02.html">Parse::Evtx::VariantType::Type0x02</a>, <a href="./docs/html/./Log2t/input/jp_ntfs_change.html">Log2t::input::jp_ntfs_change</a>, <a href="./docs/html/./Log2t/input/ntuser.html">Log2t::input::ntuser</a>, <a href="./docs/html/./Log2t/input/setupapi.html">Log2t::input::setupapi</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x81.html">Parse::Evtx::VariantType::Type0x81</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x00.html">Parse::Evtx::VariantType::Type0x00</a>, <a href="./docs/html/./Log2t/input/syslog.html">Log2t::input::syslog</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x11.html">Parse::Evtx::VariantType::Type0x11</a>, <a href="./docs/html/./Parse/Evtx/BXmlNode/Node0x0e.html">Parse::Evtx::BXmlNode::Node0x0e</a>, <a href="./docs/html/./Log2t/WinReg.html">Log2t::WinReg</a>, <a href="./docs/html/./Log2t/input/mcafeehs.html">Log2t::input::mcafeehs</a>, <a href="./docs/html/./Parse/Evtx/VariantType/Type0x10.html">Parse::Evtx::VariantType::Type0x10</a>, <a href="./docs/html/./Log2t/input/wmiprov.html">Log2t::input::wmiprov</a>, <a href="./docs/html/./Log2t/input/mcafeehel.html">Log2t::input::mcafeehel</a>, <a href="./docs/html/./Log2t/input/encase_dirlisting.html">Log2t::input::encase_dirlisting</a>, <a href="./docs/html/./Parse/Evtx/Event.html">Parse::Evtx::Event</a>, <a href="./docs/html/./Log2t/Common.html">Log2t::Common</a>, <a href="./docs/html/./Log2t/output/mactime.html">Log2t::output::mactime</a>, <a href="./docs/html/./Log2t/Network.html">Log2t::Network</a>, <a href="./docs/html/./Log2t/input/prefetch.html">Log2t::input::prefetch</a>, <a href="./docs/html/./Log2t/input/safari.html">Log2t::input::safari</a>, <a href="./docs/html/./Log2t/input/generic_linux.html">Log2t::input::generic_linux</a>, <a href="./docs/html/./Log2t/output/tlnx.html">Log2t::output::tlnx</a>, <a href="./docs/html/./Log2t/input/sol.html">Log2t::input::sol</a>, <a href="./docs/html/./Parse/Evtx/BXmlNode/Node0x03.html">Parse::Evtx::BXmlNode::Node0x03</a>, <a href="./docs/html/./Log2t/PreProc/win_sysinfo.html">Log2t::PreProc::win_sysinfo</a>, <a href="./docs/html/./Parse/Evtx/BXmlNode/Node0x02.html">Parse::Evtx::BXmlNode::Node0x02</a>, <a href="./docs/html/./Log2t/input/system.html">Log2t::input::system</a>, <a href="./docs/html/./Log2t/output/sqlite.html">Log2t::output::sqlite</a>, <a href="./docs/html/dev/chrome_cache.html">dev::chrome_cache</a>, <a href="./docs/html/./Log2t/Win.html">Log2t::Win</a>, <a href="./docs/html/./Parse/Evtx/BXmlNode/Node0x06.html">Parse::Evtx::BXmlNode::Node0x06</a>, <a href="./docs/html/./Log2t/input/chrome.html">Log2t::input::chrome</a>, <a href="./docs/html/./Log2t/input/ff_bookmark.html">Log2t::input::ff_bookmark</a>, <a href="./docs/html/./Log2t/input/ff_cache.html">Log2t::input::ff_cache</a>, <a href="./docs/html/./Log2t/input/mcafeefireup.html">Log2t::input::mcafeefireup</a></p>
<p><strong>Source Code:</strong> <A HREF=./lib/Parse/Evtx/Chunk.pm>Parse::Evtx::Chunk</A></p>
<p>
</p>
<hr />
<h1><a name="history">HISTORY</a></h1>
<dl>
<dt><strong><a name="0" class="item">v1.0.0 (2007-08-10) Initial release.
=item v1.0.1 (2009-12-21) Bugfixes, improved parsing of header.
=item v1.0.3 (2010-02-11) Implemented CRC32 check of chunk header.
=item v1.0.4 (2010-03-24) Added CRC32 check of event data.</a></strong></dt>

</dl>
<p>
</p>
<hr />
<h1><a name="author">AUTHOR</a></h1>
<p>Andreas Schuster (<a href="mailto:schuster@cpan.org">schuster@cpan.org</a>)</p>
<p>
</p>
<hr />
<h1><a name="license_and_copyright">LICENSE AND COPYRIGHT</a></h1>
<p>This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2, or (at your option)
any later version.</p>
<p>This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software Foundation,
Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.</p>

</body>

</html>
